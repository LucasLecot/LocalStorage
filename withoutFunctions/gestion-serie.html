<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1">
    <title>Gestionnaire de série</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.0/css/bulma.min.css">
    <style>
        body {
            padding: 50px;
        }

        .title {
            text-align: center;
        }

        .container form {
            max-width: 60%;
            margin: 40px auto;
        }

        .container .list {
            padding: 20px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        .container .columns {
            border-bottom: 1px solid #ccc;
        }

        .container .columns:last-child {
            border-bottom: 0;
        }

        .current-eps {
            padding: 0 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="title is-1 has-text-centered">Gestionnaire de série en tout genre</h1>

    <form action="">
        <div class="field">
            <label class="label">Type</label>
            <p class="control">
                <input class="input" type="text">
            </p>
        </div>

        <div class="field">
            <label class="label">Titre</label>
            <p class="control">
                <input class="input" type="text">
            </p>
        </div>

        <div class="field">
            <label class="label">Episodes total</label>
            <p class="control">
                <input class="input" type="number">
            </p>
        </div>

        <div class="field">
            <label class="label">Episodes vus</label>
            <p class="control">
                <input class="input" type="number">
            </p>
        </div>

        <div class="field">
            <p class="control">
                <button class="button is-success">Ajouter</button>
            </p>
        </div>
    </form>

    <h2 class="title is-2">List des séries ajoutées</h2>

    <div class="list">
        <div class="field has-addons">
            <p class="control">
                <a class="button">
                    <span>Manga</span>
                </a>
            </p>
            <p class="control">
                <a class="button">
                    <span>Livre</span>
                </a>
            </p>
            <p class="control">
                <a class="button">
                    <span>Séries</span>
                </a>
            </p>
        </div>


        <div class="columns">
            <div class="column"><strong>Type</strong></div>
            <div class="column"><strong>Titre</strong></div>
            <div class="column"><strong>Episodes en cours</strong></div>
            <div class="column"><strong>Episodes </strong></div>
        </div>
    </div>
</div>

<script>
    var inputs = document.querySelectorAll('.input');
    var btn = document.querySelector('button');
    var list = JSON.parse(localStorage.getItem('liste')) || [];

    btn.addEventListener('click', function() {
        var obj = {
            type: inputs[0].value,
            titre: inputs[1].value,
            episode_max: inputs[2].value,
            episode_vu: inputs[3].value
        };
        list.push(obj);
        localStorage.setItem('liste', JSON.stringify(list));
    });

    for (let i = 0; i < list.length; i++) {
        var divColumns = document.createElement("div");
        divColumns.classList = "columns";

        for (var j = 0; j < 4; j++) {
            var divColumn = document.createElement("div");
            divColumn.classList = "column";

            switch (j) {
                case 0:
                    var text = document.createTextNode(list[i].type);
                    divColumn.appendChild(text);
                    break;
                case 1:
                    var text = document.createTextNode(list[i].titre);
                    divColumn.appendChild(text);
                    break;
                case 2:
                    var text = document.createTextNode(list[i].episode_vu);
                    var span = document.createElement("span");

                    span.classList = "current-eps";
                    span.appendChild(text);
                    divColumn.appendChild(span);
                    for (var k = 1; k < 3; k++) {
                        var createA = document.createElement("a");
                        if (k == 1) {
                            createA.classList = "plus button";
                            var textPlus = document.createTextNode(" + ");
                            createA.appendChild(textPlus);
                            divColumn.appendChild(createA);
                            createA.addEventListener('click', function() {
                                if (parseInt(list[i].episode_vu) < parseInt(list[i].episode_max)) {
                                    list[i].episode_vu = parseInt(list[i].episode_vu) + 1;
                                    list[i].episode_vu = list[i].episode_vu.toString();
                                    localStorage.setItem('liste', JSON.stringify(list));
                                    location.reload();
                                }
                            });
                        } else {
                            createA.classList = "minus button";
                            var textMoins = document.createTextNode(" - ");
                            createA.appendChild(textMoins);
                            divColumn.appendChild(createA);
                            createA.addEventListener('click', function() {
                                if (parseInt(list[i].episode_vu ) > 0) {
                                    list[i].episode_vu = parseInt(list[i].episode_vu) - 1;
                                    list[i].episode_vu = list[i].episode_vu.toString();
                                    localStorage.removeItem('liste');
                                    localStorage.setItem('liste', JSON.stringify(list));
                                    location.reload();
                                }
                            });
                        }
                    }
                    break;
                case 3:
                    var text = document.createTextNode(list[i].episode_max);
                    divColumn.appendChild(text);
                    break;
            }
            divColumns.appendChild(divColumn);
        }
        document.querySelector(".list").appendChild(divColumns);
    }

</script>
</body>
</html>